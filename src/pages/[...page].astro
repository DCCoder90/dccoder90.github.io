---
import BaseLayout from "../layouts/BaseLayout.astro";
import PostPreview from "../components/PostPreview.astro";
import Pagination from "../components/Pagination.astro";
import { siteConfig } from "../config.ts";
import Hero from "../components/Hero.astro";

export async function getStaticPaths({ paginate }) {
  const allPosts = await Astro.glob("./posts/*.md");
  const sortedPosts = allPosts.sort((a, b) => new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf());
  
  return paginate(sortedPosts, { pageSize: siteConfig.postsPerPage });
}

const { page } = Astro.props;
const pageTitle = `Blog - Page ${page.currentPage}`;
---
<BaseLayout pageTitle={pageTitle}>
  {page.currentPage === 1 && <Hero />}
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 md:py-16 lg:py-24">

    <div class="text-center mb-12 sm:mb-16 md:mb-20">
      <div class="inline-flex items-center justify-center mb-4 sm:mb-6">
        <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-gradient-to-br from-[#0969da] to-[#0550ae] dark:from-teal-400 dark:to-teal-600 flex items-center justify-center shadow-lg">
          <svg class="w-6 h-6 sm:w-7 sm:h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
          </svg>
        </div>
      </div>
      <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-neutral-100 mb-3 sm:mb-4 leading-tight px-4">
        Latest Posts
      </h1>
      <p class="text-base sm:text-lg md:text-xl text-gray-700 dark:text-neutral-400 max-w-2xl mx-auto leading-relaxed px-4">
        Thoughts on software development, technology, and learning new things.
      </p>
    </div>

    <div class="space-y-6 sm:space-y-8 md:space-y-10">
      {page.data.map(post => <PostPreview post={post} />)}
    </div>

    <Pagination page={page} />

  </div>
</BaseLayout>
