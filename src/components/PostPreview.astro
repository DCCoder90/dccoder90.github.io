---
const { post } = Astro.props;
const tags = post.frontmatter.tags || [];
const displayTags = Array.isArray(tags) ? tags : [tags];

const [year, month, day] = post.frontmatter.date.split('-');

const headerImageUrl = post.frontmatter.headerimage
  ? (post.frontmatter.headerimage.startsWith('/') || post.frontmatter.headerimage.includes('://') ? post.frontmatter.headerimage : `/imgs/posts/${year}/${month}/${day}/${post.frontmatter.headerimage}`)
  : null;
console.log(headerImageUrl)
---

<article class="group relative flex flex-col bg-white dark:bg-[#262626] rounded-xl border border-gray-200 dark:border-neutral-700 shadow-sm hover:shadow-xl dark:hover:shadow-2xl dark:hover:shadow-black/30 transition-all duration-300 overflow-hidden">
  <div class="absolute top-0 left-0 w-1 h-full bg-gradient-to-b from-[#0969da] to-[#0550ae] dark:from-teal-400 dark:to-teal-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>

  {headerImageUrl && (
    <img src={headerImageUrl} alt={post.frontmatter.title} class="w-full h-48 object-cover rounded-t-xl" />
  )}

  <div class="p-8">
    <a href={post.url} class="flex-grow block">
      <h2 class="text-2xl font-bold text-gray-900 dark:text-neutral-100 mb-3 group-hover:text-[#0969da] dark:group-hover:text-teal-400 transition-colors leading-tight">
        {post.frontmatter.title}
      </h2>
      <p class="text-base text-gray-700 dark:text-neutral-300 mb-5 leading-relaxed line-clamp-3">
        {post.frontmatter.description}
      </p>
    </a>

    {displayTags.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-5">
        {displayTags.slice(0, 3).map((tag: string) => (
          <span class="inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-gray-100 dark:bg-neutral-800 text-gray-700 dark:text-neutral-300 border border-gray-200 dark:border-neutral-700">
            {tag}
          </span>
        ))}
      </div>
    )}

    <div class="flex items-center justify-between pt-5 border-t border-gray-100 dark:border-neutral-800">
      <div class="flex items-center gap-2 text-sm text-gray-600 dark:text-neutral-400">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
        <time datetime={post.frontmatter.date}>
          {new Date(post.frontmatter.date).toLocaleDateString('en-us', {
            year: 'numeric',
            month: 'short',
            day: 'numeric',
          })}
        </time>
      </div>
      <a href={post.url} class="inline-flex items-center gap-2 text-sm font-semibold text-[#0969da] dark:text-teal-400 hover:text-[#0550ae] dark:hover:text-teal-300 transition-colors group/link">
        Read Article
        <svg class="w-4 h-4 transition-transform group-hover/link:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
        </svg>
      </a>
    </div>
  </div>
</article>