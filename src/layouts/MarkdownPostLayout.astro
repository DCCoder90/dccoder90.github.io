---
import BaseLayout from './BaseLayout.astro';
const { frontmatter } = Astro.props;
import { siteConfig } from "../config";
import "../styles/global.css";

const author = frontmatter.author ?? siteConfig.author;

const headerImageUrl = frontmatter.headerimage
  ? (frontmatter.headerimage.startsWith('/') || frontmatter.headerimage.includes('://') ? frontmatter.headerimage : `/imgs/posts/${frontmatter.date}/${frontmatter.headerimage}`)
  : null;
---
<BaseLayout pageTitle={frontmatter.title}>
  {headerImageUrl && (
    <div
      class="relative w-full max-h-96 my-8 mx-auto rounded-lg overflow-hidden flex items-center justify-center p-8 text-center"
      style={`background-image: url(${headerImageUrl}); background-size: cover; background-position: center;`}
    >
      <div class="relative z-10">
        <h1 class="text-white text-4xl md:text-5xl font-bold drop-shadow-lg" style="text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); color: white;">
          {frontmatter.title}
        </h1>
        <p class="text-white text-lg mt-2 drop-shadow-lg">Written by {author}</p>
        <div class="tags mt-4 flex flex-wrap justify-center gap-2">
          {frontmatter.tags.map((tag: string) => (
            <p class="tag text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm drop-shadow-lg"><a href={`/tags/${tag}`}>{tag}</a></p>
          ))}
        </div>
      </div>
    </div>
  )}
  {!headerImageUrl && (
    <div class="text-center my-8">
      <h1 class="text-4xl md:text-5xl font-bold">
        {frontmatter.title}
      </h1>
      <p class="text-lg mt-2">Written by {author}</p>
      <div class="tags mt-4 flex flex-wrap justify-center gap-2">
        {frontmatter.tags.map((tag: string) => (
          <p class="tag px-3 py-1 rounded-full text-sm"><a href={`/tags/${tag}`}>{tag}</a></p>
        ))}
      </div>
    </div>
  )}
  <div class="article prose dark:prose-invert max-w-3xl mx-auto bg-white dark:bg-neutral-800 p-6 rounded-lg shadow-lg my-8">
    <slot />
  </div>

</BaseLayout>